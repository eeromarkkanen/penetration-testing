# h3 - Täysin laillinen sertifikaatti

## x) 

### OWASP Top 10: A01 Broken Access Control
- Sivulla kerrotaan OWASP:n yleisimmästä ohjelmiston turvallisuusuhasta Broken Access Controlista.
- Käytännössä tämä tarkoittaa, että käyttäjä pystyy katselemaan, muokkaamaan tai jopa tuhoamaan tietoja tai tiedostoja, joihin hänellä ei ole käyttöoikeuksia.
- Seuraavaksi annetaan esimerkkejä, millä tavoilla tämä tapahtuu, kuten URL:n muokkaus tai käyttöoikeuksien korotus.
- Miten estää tällaisia hyökkäyksiä.
- Ja lopuksi esimerkkihyökkäyksiä. [Kopioitu oma github](https://github.com/eeromarkkanen/Application-Hacking-and-Vulnerabilities/blob/main/h2-Break-and-Unbreak.md)

### IDOR

- Insecure direct object references
- Liitetään yleisesti sivuittaisliikeeseen verkossa jossa korotetaan käyttäjän oikeuksia
- Esimerkeissä mahdollisia kohteita, joissa esimerkiksi käyttäjän ID tai tiedoston nimi esillä

### Path Traversal

- Antaa hyökkääjälle mahdollisuuden hakea tiedostoja, joihin hänellä ole oikeuksia
- Hyökkääjä voi käyttää esimerkiksi ../ tyyppisiä ketjuja hakeakseen tietoja
- Lisäksi sivulle neuvotaan keinoja estää tällainen hyökkäys

  ### Cross-site scripting (XSS)
- Haavoittuvuus, jossa verkkosivulle on syötetty haitallinen koodi, joka ajetaan kun käyttäjä käyttää sivua
- Kolme eri tyyppiä; Reflected, stored ja DOM-based
- Ja lopuksi kerrotaan erilaisista puolustuskeinoista


[Tehtävänanto ja kurssisivu](https://terokarvinen.com/tunkeutumistestaus/#h3-taysin-laillinen-sertifikaatti)

## a)  Totally Legit Sertificate. Asenna OWASP ZAP, generoi CA-sertifikaatti ja asenna se selaimeesi.

Asensin zaproxyn ajamalla sudo apt-get install zaproxy. Sitten Tools-välilehdeltä Options ja Network, josta löytyi Server certificate. Loin uuden certifikaatin painamalla Generate. Lopuksi vielä Save ja tallensin sertifikaatin tiedostoihin.

<img width="754" height="585" alt="image" src="https://github.com/user-attachments/assets/7ec9467f-0dc4-4b95-9cbc-92199e0f0765" />

Sen jälkeen avasin Firefoxin Settings -välilehden ja etsin sanalla Certificate. Täältä löytyi View Certificates, josta näin jo olemassa olevat sertifikaatit. Alhaalta valitsin Import, jolla pystyin lisäämään juuri luomani ZA Proxy sertifikaatin.

<img width="745" height="496" alt="image" src="https://github.com/user-attachments/assets/6496b52c-7536-4c57-9b83-26bf5dc82cda" />

## b) FoxyProxy

Tässä kohtaa kysyin ChatGPT:ltä käyttöohjeet FoxyProxyn asettamiseen oikein tehtävänannon mukaan, koska en itse osannut löytää oikeita kohtia. Loin ZAP proxyn ja lisäsin sinne portswigger.net, 127.0.0.1 ja localhost patterneiksi. Lopulta valitsin yläkulmasta Proxy by Patterns:

<img width="326" height="349" alt="image" src="https://github.com/user-attachments/assets/0ef88ed6-bb50-4e0b-a1ca-d15e090a7e89" />

Sitten kokeilin, miten sivut näkyvät ZAP:ssa. Lisätyt sivut näkyvät, mutta kun kävin google.com, se ei ilmestynyt listaan.

<img width="1780" height="361" alt="image" src="https://github.com/user-attachments/assets/2f6dbb25-50ed-4162-8393-8c70e1e85a75" />

## c) Reflected XSS into HTML context with nothing encoded

Avasin [labraharjoituksen](https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded) ja loin tunnuksen sivuille. En oikein ymmärtänyt mitä tapahtuu, joten avasin ratkaisun ja syötin sen sivun hakukenttään.

Kyseessä oli siis reflected XSS, jossa hyökkääjän syöte aiheutti sen, että verkkosivu suoritti koodin ja paljasti haavoittuvuuden.

## d) Stored XSS into HTML context with nothing encoded

Seuraava harjoitus oli stored XSS. Avasin postauksen ja menin kommenttikenttään kuin ohjeessa sanottiin. Luin ensin lisää stored XSS ja kuinka minun pitäisi tehdä se.

Kokeilin samaa ratkaisua kuin ensimmäisessä, ja se toimi.

<img width="731" height="342" alt="image" src="https://github.com/user-attachments/assets/968ccbc8-c738-42c9-a745-3e85955693cc" />

Tässä tapauksessa scripti tallentui kommenttina, ja sivu suoritti koodin kun se ladattiin uudelleen. 

## e) 

Näitä haavoittuvuuksia käyttämällä hyökkääjä voi varastaa käyttäjän tietoja, kuten kirjautumistunnuksia ja salasanoja. Esimerkiksi pankkien tai postin huijausviestit, joissa käyttäjä ohjataan oikealta näyttävälle kirjautumissivulle ovat esimerkkejä tällaisesta.

## f)

Tässä piti muokata filename kohdasta imagen tilalle ../../../etc/passwd. En kuitenkaan saanut näkyviin salasanaa tai kuvia, mutta sivulle tuli Lab Solved.

<img width="1171" height="276" alt="image" src="https://github.com/user-attachments/assets/750a14d5-ff38-4799-b67b-8f5d015fe0f3" />

## g)

Seuraava tehtävä oli hyvin samanlainen, mutta se esti ../../../ -käytön, joten pelkkä /etc/passwd riitti harjoituksen ratkaisuun.

## h)

Tässä kohdassa on estetty ../../../ ja /etc/passwd käyttö, joten pitää löytää jokin muu tapa löytää oikea tiedosto. Yritin etsiä apua minkälaisia asioita minun kannattaisi kokeilla, mutta [tämä](https://anmolsinghthakur.medium.com/lab-3-file-path-traversal-traversal-sequences-stripped-non-recursively-90ddd55232c5) antoikin vain suoraan ratkaisun eli ....//....//....//. Tässä oli siis blokattu yksinkertaiset tavat löytää tiedosto, mutta ei kaikkia. 

## i) IDOR

Tässä kohdassa heikkous oli Live Chatissa, joka palautti transscriptiä ladattaessa 2.txt tiedoston. Vaihtamalla numeroa saatiin vanhoja logeja joista löytyi Carloksen keskustelu jossa oli salasana. [Lähde](https://www.youtube.com/watch?v=jgbHaALms_Q)

## Lähteet

Kurssisivu ja tehtävänanto: https://terokarvinen.com/tunkeutumistestaus/#h3-taysin-laillinen-sertifikaatti

Oma GitHub: https://github.com/eeromarkkanen/Application-Hacking-and-Vulnerabilities/blob/main/h2-Break-and-Unbreak.md

ChatGPT: ZAP ja FoxyProxy käyttöohjeet. chat.openai.com ChatGPT 5

Anmol Singh Thakur. Lab(3): File path traversal, traversal sequences stripped non-recursively. Luettavissa: https://anmolsinghthakur.medium.com/lab-3-file-path-traversal-traversal-sequences-stripped-non-recursively-90ddd55232c5 Luettu 8.9.2025

YouTube. Intigriti. How to search for IDORs!. Katsottavissa: https://www.youtube.com/watch?v=jgbHaALms_Q Katsottu 8.9.2025










