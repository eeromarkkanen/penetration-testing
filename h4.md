# h4 Fuzzy

## x) Tiivistelmä

### [Find Hidden Web Directories - Fuzz URLs with ffuf](https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/)

- Sivulla käydään ffuf:n perusteet ja asennus
- Ladataan myös sanalista ja näytetään miten sitä käytetään
- Sitten harjoitusmaalin asennus ja harjoittelu

  Todella selkeästi selitetty ffuf:n käyttö, vaikutti todella selkeältä itsellenikin heti alusta.

### ffuf README.md

- Tiedostosta löytyy ffuf asennus- ja käyttöohjeet
- Miten fuzzata hakemistoja, alidomaineja ja parametrejä
- Esimerkkejä myös POST fuzzauksesta, jota me emme tässä harjoituksessa tehneet
- Lisäksi esimerkki fuzzauksen maksimiajasta ja yhdistämisestä rekursiiviseen hakuun, jotta se ei etsi loputtomiin mutta etsii uudestaan löydettyään hakemiston

  Tarkoituksena katsoa myös joohoi:n HelSec Virtual Meetup, mutta en vielä ehtinyt katsoa sitä sunnuntai-iltana.

## a) dirfuzt-1

Latasin dirfuzt-1 ja käynnistin ohjelman. Tämän jälkeen toisessa shellissä ajoin komennon

    ffuf -w common.txt -u http://127.0.0.2:8000/FUZZ

Tuloksia on todella paljon, ja isossa osassa näyttäisi olevan kokona 154, joten rajataan ne pois lisäämällä -fs 154.

Sieltä löytyikin sivu wp-admin, josta löytyi lippu: 

<img width="490" height="167" alt="image" src="https://github.com/user-attachments/assets/af6d27ab-f37b-4a68-854c-ffed48347b42" />

Muut listauksessa löytyneet .git alkuisen sivut palauttivat kaikki tämän lipun.

<img width="444" height="159" alt="image" src="https://github.com/user-attachments/assets/84e3a1c7-3539-4a5e-8cd1-38208c02c2f5" />

Nähtävissä myös curl -komennolla.

## b)  Fuff me. Asenna FuffMe-harjoitusmaali.

Asensin harjoitusmaalin [ohjeiden](https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/) mukaan. 

Sain ongelman, että portti on jo käytössä, joten minun piti sulkea apache2.service ohjeen mukaan.

Sitten lähti toimimaan.

## c) Basic Content Discovery

Ensimmäisenä piti vain fuzzata osoite ja löytää sieltä löytyvät sivut. Tuloksena oli class josta löytyi tämä sivu. Samanlainen tulos oli myös toisessa development.log tuloksessa.

<img width="813" height="118" alt="image" src="https://github.com/user-attachments/assets/78b8b999-2ef0-4bf8-8c30-27fbd7a1e3e3" />

<img width="673" height="42" alt="image" src="https://github.com/user-attachments/assets/0c9ccc15-9639-4c71-8ac2-51c0014e891c" />

## d) Content Discovery With Recursion

Tässä kohdassa käytetään -recursion komentoa. Tämä etsii löydettyään hakemiston tuloksia tämän hakemiston sisältä. Joten löydettyään hakemiston admin ffuf löysi sen sisältä myös users ja users/96.

<img width="878" height="118" alt="image" src="https://github.com/user-attachments/assets/c2790a29-f7f8-4c59-826d-abcb5ce47ed3" />

<img width="762" height="131" alt="image" src="https://github.com/user-attachments/assets/1d9f7f17-7f28-4467-a994-8df90454feb9" />

## e) Content Discovery With File Extensions

Tässä kohdassa etsittiin .log päätteisiä tiedostoja. Käyttämällä -e .log fuzzaus kohdistui .log päätteisiin hakemistoihin.

<img width="675" height="22" alt="image" src="https://github.com/user-attachments/assets/b72e6eba-bb47-4239-8b94-363be2d6e6d0" />

<img width="525" height="86" alt="image" src="https://github.com/user-attachments/assets/f22a823b-9b4b-4c98-991d-c47798cf8e4b" />

## f) No 404 Status

Seuraavassa kohdassa saatiin erittäin paljon tuloksia, joista melkein kaikki olivat saman kokoisia "Page not found" sivuja.

<img width="807" height="69" alt="image" src="https://github.com/user-attachments/assets/f094b318-275a-4c4b-ab1b-a4e718fdef49" />

Joten otetaan pois tiedoston koko 669 ja fuzzataan uudestaan lisäämällä -fs 669 perään.

Jäljelle jäi vain yksi sivu: secret. Se palauttaa tämän näköisen sivun:

<img width="510" height="81" alt="image" src="https://github.com/user-attachments/assets/fa44c226-70e3-4ef5-8de7-414196dfe454" />

## g) Param Mining

<img width="475" height="77" alt="image" src="https://github.com/user-attachments/assets/bce5b12b-07f5-4ab9-8914-518609eb7284" />

Tässä tehtävässä pitää löytää puuttuva parametri. Käytetään eri sanalistaa parameters.txt

<img width="810" height="71" alt="image" src="https://github.com/user-attachments/assets/1727e8f2-f3d4-4684-a2c8-5a47d1769b01" />

Tuloksia oli vain yksi, debug. Lisätään URL:n FUZZ:n tilalle debug ja tarvittava sivu löytyi.

<img width="533" height="82" alt="image" src="https://github.com/user-attachments/assets/8d422d3c-2164-4823-8bf8-339366c52164" />

## h) Rate Limited

Ensimmäiseksi piti ajaa seuraava komento:

<img width="803" height="63" alt="image" src="https://github.com/user-attachments/assets/e3aa7fe5-2d9d-4960-b93a-f807e4571cd1" />

Tässä käytettiin -mc komentoa jonka kuvaus on "Match HTTP status codes" eli tuloksena pitäisi tulla ne, joiden status on 200 tai 429. Tämä palautti minulla vain error.

Vaihdoin osoitteen muotoon localhost/cd/rate ja sain toimimaan. Tuloksena oli paljon 429 koodeja. Lisätään -t 5 ja -p 0.1 eli hidastetaan hakua hieman ja kierretään tämä 429 status.

Tuloksena oli sivu oracle:

<img width="930" height="66" alt="image" src="https://github.com/user-attachments/assets/eb025b55-f56a-4fd2-a8ce-a178601c4104" />

<img width="519" height="88" alt="image" src="https://github.com/user-attachments/assets/72a11704-3a3d-4e01-8109-781821f88418" />

## i) Subdomains - Virtual Host Enumeration

Tässä tehtävässä haettiin alidomaineja. Hieman erilainen komento ja eri sanalista. Tuloksena paljon sivuja joiden koko on 1495, joten filtteröidään se seuraavassa pois.

<img width="813" height="68" alt="image" src="https://github.com/user-attachments/assets/063fb72e-852e-4984-9c28-1d52445b441d" />

Tuloksena löytyi redhat.

<img width="927" height="47" alt="image" src="https://github.com/user-attachments/assets/a425e8d3-b7e9-4b32-a2de-cf8a2db58bed" />

## Lähteet

Kurssisivu ja tehtävänanto: https://terokarvinen.com/tunkeutumistestaus/#h4-fuzzy

Find Hidden Web Directories - Fuzz URLs with ffuf: https://terokarvinen.com/2023/fuzz-urls-find-hidden-directories/

Fuffme - Install Web Fuzzing Target on Debian: https://terokarvinen.com/2023/fuffme-web-fuzzing-target-debian/

ffuf README.md: https://github.com/ffuf/ffuf/blob/master/README.md


Bonuksena ärsyttävä kielioppivirhe ffuf.me:

<img width="365" height="34" alt="image" src="https://github.com/user-attachments/assets/70d222de-9f1c-4ce1-b8a6-2cfaccd17667" />


